{% extends "auctions/layout.html" %}

{% block body %}
<div class="container-fluid">

    <div class="container">

        <h2>{{ listing.title }}</h2>
        <div class="row my-3">
            {% if user.is_authenticated %}
            {% if hasWatchers %}
            <form action="{% url 'removeWatchlist' id=listing.id %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm">Remove from Watchlist</button>
            </form>
            {% else %}
            <form action="{% url 'addWatchlist' id=listing.id %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn btn-success btn-sm">Add to Watchlist</button>
            </form>
            {% endif %}
            {% endif %}
        </div>

        <img src="{{ listing.image }}" alt="{{ listing.title }}">
        <p class="my-2">{{ listing.description }}.</p>
        <p class="my-2"><strong>Owner:</strong> {{ listing.user }}.</p>
        <h4 class="">${{ listing.start_bid }}</h4>
        <hr>
        <p class=""><small class="text-body-secondary">Created {{ listing.start_date}}</small>
        </p>
        <div class="row my-3">
            <h2>Comments</h2>
            <div class="my-3">
                {% for comment in comments %}
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <div>
                            <h5>{{ comment.user }}</h5>
                            <p>{{ comment.comment }}</p>
                            <p><small>{{ comment.datetime }}</small></p>
                        </div>
                    </li>
                </ul>

                {% empty %}

                <h5>No comments yet.</h5>
                <span>Be the fist one.</span>

                {% endfor %}
            </div>

            {% if user.is_authenticated %}
            <form action="{% url 'addComment' id=listing.id %}" method="post">
                {% csrf_token %}
                <div class="mb-3">
                    <label for="newComment" class="form-label">New Comment</label>
                    <input type="text" name="newComment" class="form-control" id="newComment"
                        aria-describedby="newCommentHelp">
                    <div id="newCommentHelp" class="form-text">Max. 300 character.</div>
                </div>
                <button type="submit" class="btn btn-primary">Post</button>
            </form>
            {% endif %}

        </div>

    </div>


    {% endblock %}